<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T Mart - Your Shopping Destination</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* Initial Full Page Loader */
        #initialPageLoader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #ffffff; /* Or var(--light-bg) */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999; /* Highest z-index */
        }
        #initialPageLoader .spinner-dark {
            width: 50px;
            height: 50px;
            border-width: 5px;
        }

        /* Global Resets and Variables */
        :root {
            --primary-color: #2874f0; 
            --primary-color-dark: #1e5799;
            --secondary-color: #ff9f00; 
            --success-color: #28a745; 
            --danger-color: #dc3545; 
            --light-bg: #f1f3f6;
            --white-color: #ffffff;
            --dark-text: #212121;
            --medium-text: #555555;
            --light-text: #878787;
            --border-color: #e0e0e0;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; } 
        body { 
           background-color: var(--light-bg); 
           color: var(--dark-text); 
           font-size: 14px; 
           font-family: 'Roboto', Arial, sans-serif; /* Added Roboto as primary */
        } 

        /* Logged-out Main Content Styles */
        .container#mainContent {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            padding-bottom: 80px; 
        }
        .photo-box { width: 100%; margin-bottom: 30px; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        .photo-box img { width: 100%; height: auto; display: block; }
        .promo-section { background-color: #f8f8f8; padding: 30px; border-radius: 10px; margin-bottom: 30px; }
        .promo-title { font-size: 24px; font-weight: bold; color: #FF9900; margin-bottom: 20px; }
        .promo-highlight { font-size: 20px; font-weight: bold; margin: 15px 0; }
        .stats-container { display: flex; flex-wrap: wrap; justify-content: space-between; margin-top: 30px; }
        .stat-box { width: 48%; background-color: white; padding: 15px; margin-bottom: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .stat-number { font-size: 28px; font-weight: bold; color: #FF9900; }
        .stat-text { font-size: 14px; }
        .app-section { background-color: #232F3E; color: white; padding: 40px; border-radius: 10px; text-align: center; margin-bottom: 30px; }
        .app-section .app-title { font-size: 28px; margin-bottom: 20px; } 
        .app-description { font-size: 18px; line-height: 1.6; max-width: 800px; margin: 0 auto 30px; }
        .app-features { display: flex; justify-content: center; flex-wrap: wrap; gap: 20px; margin-top: 30px; }
        .feature { background-color: #37475A; padding: 15px 25px; border-radius: 30px; font-size: 16px; }
        .reviews-section { padding: 20px; margin-bottom: 30px; }
        .review-title { text-align: center; margin-bottom: 20px; } 
        .review-box { background-color: #f5f5f5; padding: 20px; border-radius: 10px; margin-bottom: 15px; }
        .review-text { font-style: italic; }
        .review-author { text-align: right; font-weight: bold; }

        /* Fixed Button (Sign Up/Register) */
        .fixed-button { 
            position: fixed; bottom: 0; left: 0; right: 0; background-color: white;
            padding: 15px; box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            display: flex; justify-content: center; z-index: 1000;
        }
        #mainActionButton.btn { 
            padding: 12px 30px; border: none; border-radius: 30px; 
            font-size: 16px; font-weight: bold; cursor: pointer; 
            transition: all 0.3s; display: inline-flex; 
            align-items: center; justify-content: center; gap: 6px; 
        }
        #mainActionButton.btn-signup { 
            background-color: #FF9900; color: white; 
        }

        /* Auth Page (Login/Register Modal) Styles */
        .auth-page {
            display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background-color: #f5f5f5; z-index: 1001; overflow-y: auto; padding: 20px;
        }
        .auth-container {
            background: white; padding: 30px; border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1); width: 100%;
            max-width: 400px; margin: 20px auto;
        }
        .auth-title { color: #4b6cb7; margin-bottom: 20px; text-align: center; }
        .message {
            padding: 10px; margin-bottom: 15px; border-radius: 5px;
            text-align: center; font-size: 14px; display: none; 
        }
        .message.error { 
            background-color: #ffebee; color: #d32f2f;  
            border: 1px solid #ef9a9a; display: block; 
        }
        .message.success { 
            background-color: #e8f5e9; color: #2e7d32;   
            border: 1px solid #a5d6a7; display: block; 
        }
        .auth-input-container { 
            position: relative; display: flex; align-items: center;
        }
        .auth-input {
            width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd;
            border-radius: 6px; font-size: 16px; box-sizing: border-box; 
        }
        .auth-input-container .auth-input { padding-right: 40px; }
        .toggle-password {
            position: absolute; right: 12px; top: 50%;
            transform: translateY(-50%); cursor: pointer;
            color: #888; font-size: 18px; 
        }
        .auth-btn { 
            width: 100%; padding: 12px; background-color: #4b6cb7; color: white;
            border: none; border-radius: 6px; cursor: pointer;
            margin: 15px 0 10px; font-size: 16px; font-weight: 500;
        }
        .auth-btn .spinner { border-top-color: white; margin-left: 8px; }
        .toggle-link {
            color: #4b6cb7; text-decoration: none; display: block;
            text-align: center; margin-top: 15px; cursor: pointer; font-size: 14px;
        }
        .close-auth {
            position: absolute; top: 20px; right: 20px;
            font-size: 24px; cursor: pointer; color: #555;
        }
        
        /* New App Interface Styles */
        #appContainer { padding: 10px; max-width: 1200px; margin: 0 auto; position: relative; padding-bottom: 70px; }
        .app-header { background: linear-gradient(to right, var(--primary-color), var(--primary-color-dark)); color: var(--white-color); padding: 12px 15px; border-radius: 6px; margin-bottom: 15px; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.15); }
        .app-header h1 { font-size: 20px; font-weight: 500; display: flex; align-items: center; justify-content: center; }
        .app-header h1 i { margin-right: 8px; font-size: 22px; }
        .app-header-subtitle { font-size: 12px; color: #d1e5ff; margin-top: -6px; margin-bottom: 6px;}
        .section-title { font-size: 17px; font-weight: 500; color: var(--dark-text); margin-bottom: 12px; padding-left: 5px; border-left: 3px solid var(--primary-color); }
        
        #appContainer .btn { 
            padding: 9px 14px; border: none; border-radius: 4px; 
            font-size: 14px; font-weight: 500; cursor: pointer; 
            transition: background-color 0.2s, box-shadow 0.2s; 
            display: inline-flex; align-items: center; justify-content: center; gap: 6px; 
        }
        #appContainer .btn-primary { background-color: var(--primary-color); color: var(--white-color); } 
        #appContainer .btn-primary:hover { background-color: var(--primary-color-dark); box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        #appContainer .btn-secondary { background-color: var(--secondary-color); color: var(--white-color); } 
        #appContainer .btn-secondary:hover { background-color: #e08e00; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        #appContainer .btn-success { background-color: var(--success-color); color: var(--white-color); } 
        #appContainer .btn-success:hover { background-color: #1e7e34; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        #appContainer .btn-danger { background-color: var(--danger-color); color: var(--white-color); } 
        #appContainer .btn-danger:hover { background-color: #c82333; }
        #appContainer .btn-block { width: 100%; display: block; }
        #appContainer .btn-sm { padding: 5px 8px; font-size: 12px; gap: 4px;}

        .spinner { border: 3px solid rgba(255, 255, 255, 0.3); border-radius: 50%; border-top-color: var(--white-color); width: 16px; height: 16px; animation: spin 1s ease-in-out infinite; display: inline-block; }
        .spinner-dark { border-top-color: var(--primary-color); border-color: rgba(0,0,0,0.1); }
        @keyframes spin { to { transform: rotate(360deg); } }
        .loading-overlay { position: fixed; top:0; left:0; width:100%; height:100%; background-color: rgba(255,255,255,0.85); display: flex; justify-content: center; align-items: center; z-index: 2000; }
        .loading-overlay .spinner { width: 40px; height: 40px; border-width: 4px; }
        .toast-notification { position: fixed; bottom: 70px; left: 50%; transform: translateX(-50%); background-color: var(--dark-text); color: var(--white-color); padding: 12px 20px; border-radius: 6px; box-shadow: 0 3px 10px rgba(0,0,0,0.2); z-index: 1500; opacity: 0; transition: opacity 0.5s, bottom 0.5s; font-size: 14px; pointer-events: none; }
        .toast-notification.show { opacity: 1; bottom: 85px; pointer-events: auto; }
        .toast-notification.success { background-color: var(--success-color); } .toast-notification.error { background-color: var(--danger-color); } .toast-notification.info { background-color: var(--primary-color); }
        
        .image-slider-container { width: 100%; max-width: 800px; margin: 0 auto 20px auto; overflow: hidden; position: relative; border-radius: 8px; box-shadow: 0 3px 8px rgba(0,0,0,0.1); height: 180px; background-color: #e9ecef; }
        .image-slider { display: flex; height: 100%; transition: transform 0.5s ease-in-out; } 
        .slide { min-width: 100%; height: 100%; display:flex; align-items:center; justify-content:center; cursor: pointer; } 
        .slide img { width: 100%; height: 100%; object-fit: cover; }
        .slider-dots { position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); display: flex; } .dot { height: 8px; width: 8px; margin: 0 4px; background-color: rgba(255,255,255,0.5); border-radius: 50%; display: inline-block; cursor: pointer; transition: background-color 0.3s ease; } .dot.active { background-color: white; }
        
        .categories-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 10px; padding: 8px 0; margin-bottom: 20px; }
        .category-item { display: flex; flex-direction: column; align-items: center; padding: 10px 5px; cursor: pointer; text-align: center; border-radius: 6px; transition: transform 0.2s, box-shadow 0.2s; background-color: var(--white-color); box-shadow: 0 1px 3px rgba(0,0,0,0.07); } .category-item:hover { transform: translateY(-2px); box-shadow: 0 3px 6px rgba(0,0,0,0.1); }
        .category-item img { width: 40px; height: 40px; object-fit: contain; margin-bottom: 8px; border-radius: 50%; background-color: var(--light-bg); padding:5px;} .category-item span { font-size: 12px; color: var(--medium-text); line-height: 1.3; font-weight: 500; }
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(145px, 1fr)); gap: 12px; margin-bottom: 20px; }
        .product-grid-horizontal { display: flex; overflow-x: auto; padding-bottom: 15px; gap: 10px; }
        .product-grid-horizontal .product-card { min-width: 140px; max-width: 140px; flex-shrink: 0; }
        .product-card { background-color: var(--white-color); border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.08); padding: 10px; text-align: left; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; display: flex; flex-direction: column; }
        .product-card:hover { transform: translateY(-4px); box-shadow: 0 4px 10px rgba(0,0,0,0.12); }
        .product-card img { width: 100%; height: 120px; object-fit: contain; margin-bottom: 8px; border-radius: 6px; background-color: #f8f9fa; }
        .product-card-title { font-size: 13px; color: var(--dark-text); margin-bottom: 4px; font-weight: 500; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; height: 2.6em; line-height: 1.3em;}
        .product-card-price { font-size: 15px; color: var(--dark-text); font-weight: bold; margin-bottom: 4px; }
        .product-card-rating { font-size: 11px; color: var(--light-text); display: flex; align-items: center; margin-bottom: 6px;}
        .product-card-rating .fa-star { color: #ffc107; margin-right: 3px; }
        .card-add-to-cart-btn { background-color: var(--white-color); color: var(--primary-color); border: 1px solid var(--primary-color); padding: 5px 8px; font-size: 12px; font-weight: 500; border-radius: 4px; cursor: pointer; width: 100%; margin-top: auto; transition: background-color 0.2s, color 0.2s; }
        .card-add-to-cart-btn:hover { background-color: #e9f5ff; }
        .card-add-to-cart-btn i { margin-right: 4px; font-size: 11px;}
        #searchPageContainer, #categoryPageContainer, #productDetailPageContainer, #cartPageContainer, #invitePageContainer, #profilePageContainer, #orderHistoryPageContainer { background-color: var(--white-color); padding: 15px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.08); min-height: calc(100vh - 140px); }
        .search-input-container { margin-bottom: 15px; position: relative; display:flex; align-items:center; }
        .search-input-container input { flex-grow:1; padding: 10px 35px 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 15px; outline: none; }
        .search-input-container .clear-search-btn { position:absolute; right:8px; top:50%; transform:translateY(-50%); background:none; border:none; font-size:16px; color:var(--light-text); cursor:pointer; padding:5px; display:none;}
        .nav { position: fixed; bottom: 0; left: 0; right:0; margin: 0 auto; max-width: 1200px; background: var(--white-color); box-shadow: 0 -2px 8px rgba(0,0,0,0.1); display: flex; justify-content: space-around; padding: 8px 0; z-index: 100; border-top: 1px solid var(--border-color); }
        .nav-item { display: flex; flex-direction: column; align-items: center; cursor: pointer; color: var(--medium-text); flex: 1; text-align: center; position: relative; padding: 5px 0;} 
        .nav-item.active { color: var(--primary-color); font-weight: 500; } .nav-item.active i { transform: scale(1.1); } .nav-item i { font-size: 22px; margin-bottom: 3px; transition: transform 0.2s; } .nav-item span { font-size: 11px; }
        .cart-badge { position: absolute; top: 0px; right: 20px; background-color: var(--danger-color); color: white; border-radius: 50%; padding: 2px 6px; font-size: 10px; font-weight: bold; display: none; border: 1px solid white; }
        #productDetailPageContainer h2 { font-size: 18px; margin-bottom: 10px; }
        .product-detail-main-image { max-width: 300px; margin-bottom: 15px; display: block; margin-left: auto; margin-right: auto; }
        .product-detail-price { font-size: 22px; }
        .product-detail-rating { font-size: 13px; }
        .product-detail-actions { display: flex; gap: 10px; margin: 20px 0; }
        .product-detail-actions .btn { flex: 1; padding: 10px 5px; font-size: 14px; } 
        .add-to-cart-btn.btn-success { background-color: var(--success-color); } 
        .buy-now-btn-detail.btn-secondary { background-color: var(--secondary-color); }
        .add-to-cart-btn.btn-success i, .buy-now-btn-detail.btn-secondary i { font-size:15px; }
        .product-detail-description { font-size: 13px; } .product-detail-description h3 {font-size: 15px; }
        #cartPageContainer h2 { font-size: 20px; margin-bottom: 20px; }
        .cart-item-card { display: flex; align-items: center; background-color: var(--white-color); padding: 12px; border-radius: 8px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.07); }
        .cart-item-image img { width: 70px; height: 70px; object-fit: contain; margin-right: 12px; border-radius: 4px; background-color: #f8f9fa; }
        .cart-item-details { flex-grow: 1; }
        .cart-item-title { font-size: 14px; font-weight: 500; color: var(--dark-text); margin-bottom: 4px; }
        .cart-item-price { font-size: 15px; color: var(--dark-text); margin-bottom: 8px; }
        .cart-item-quantity { display: flex; align-items: center; margin-bottom: 8px; }
        .cart-item-quantity button { width: 26px; height: 26px; font-size: 15px; padding:0; border: 1px solid var(--border-color); background-color: #f8f9fa; color: var(--dark-text); border-radius:4px; }
        .cart-item-quantity span { font-size: 14px; margin: 0 10px; min-width:20px; text-align:center;}
        .cart-item-remove button { font-size: 18px; color: var(--danger-color); background: none; border: none; cursor: pointer; padding: 5px;}
        .cart-summary { background-color: var(--white-color); padding: 15px; margin-top: 20px; border-radius: 8px; box-shadow: 0 1px 4px rgba(0,0,0,0.08); } 
        .cart-summary-item { display:flex; justify-content:space-between; font-size: 14px; margin-bottom: 8px; color: var(--medium-text); } 
        .cart-summary-item.total { font-size: 16px; font-weight:bold; color: var(--dark-text); } 
        .cart-summary-item.total span:last-child { color: var(--primary-color);}
        .place-order-from-cart-btn.btn-secondary { padding: 12px; font-size: 15px; width:100%; margin-top:15px; background-color: var(--secondary-color) !important;}
        .empty-cart-message { text-align: center; padding: 40px 20px; font-size: 16px; color: var(--light-text); background-color: var(--white-color); border-radius: 8px; } .empty-cart-message i { display:block; font-size: 40px; margin-bottom:15px; color: var(--primary-color); opacity: 0.7;}
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.65); z-index: 1000; justify-content: center; align-items: center; overflow-y: auto; padding: 20px 0;} 
        .modal-content { background: var(--white-color); padding: 20px; width: 90%; max-width: 450px; border-radius: 10px; box-shadow: 0 5px 20px rgba(0,0,0,0.2); position: relative; margin: auto; } 
        .close-modal-btn { position: absolute; top: 12px; right: 15px; font-size: 26px; cursor: pointer; color: var(--light-text); } .close-modal-btn:hover { color: var(--dark-text); } .modal-content h2 { font-size: 18px; margin-bottom: 15px; } 
        .modal-content input, .modal-content textarea { width: 100%; box-sizing: border-box; padding: 10px; margin-bottom: 8px; font-size: 14px; border: 1px solid var(--border-color); border-radius: 4px; } 
        .modal-content button[type="submit"].btn-secondary { padding: 10px; font-size: 15px; background-color: var(--secondary-color) !important; } .form-row { display: flex; gap: 8px; } .form-row .form-group { flex: 1; } .form-group { margin-bottom: 8px; } 
        #orderHistoryPageContainer .order-item { display: flex; align-items: center; border: 1px solid var(--border-color); padding: 12px; margin: 10px 0; border-radius: 8px; background: var(--white-color); font-size: 13px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); } 
        .order-item-image-container { margin-right: 12px; flex-shrink: 0; } .order-item-image-container img { width: 60px; height: 60px; object-fit: contain; border-radius: 6px; background-color: #f8f9fa; border: 1px solid #f0f0f0; cursor: pointer; } .order-item-details { flex-grow: 1; } #orderHistoryPageContainer .order-item p { margin: 3px 0; line-height: 1.5; } #orderHistoryPageContainer .order-item strong { color: var(--dark-text); } #orderHistoryPageContainer .order-item .status-pending { color: var(--secondary-color); font-weight: bold; } #orderHistoryPageContainer .order-item .status-completed { color: var(--success-color); font-weight: bold; } #orderHistoryPageContainer .order-item .status-rejected { color: var(--danger-color); font-weight: bold; }
        #imagePreviewModal .modal-content { padding: 15px; max-width: 350px; background-color: var(--dark-text); } #imagePreviewModal img { width: 100%; height: auto; display: block; border-radius: 6px; } #imagePreviewModal .close-modal-btn { color: var(--white-color); }
        .page-content-container { background: var(--white-color); padding: 15px; border-radius: 8px; margin: 0; box-shadow: 0 2px 6px rgba(0,0,0,0.08); min-height: calc(100vh - 140px);} .page-content-container h2 { color: var(--primary-color); margin-bottom: 15px; text-align: center; font-size: 18px; font-weight: 500;}
        #invitePageContainer h3 { font-size: 15px; color: var(--dark-text); margin-top: 18px; margin-bottom: 8px;} .referral-balance { font-size: 26px; font-weight: bold; color: var(--success-color); margin-bottom: 5px; cursor: pointer; } .referral-balance-text { font-size:13px; color: var(--medium-text); margin-bottom:18px;} .referral-info { background-color: #e9f5ff; padding: 12px; border-radius: 6px; text-align: left; margin-bottom: 18px; border: 1px solid #b3d7ff;} .referral-info p { font-size: 13px; color: var(--primary-color-dark); line-height: 1.6; } .referral-code-display, .invite-link-display { word-break: break-all; margin: 10px 0; padding: 10px; background: #f0f2f5; border-radius: 6px; font-weight: 500; color: var(--dark-text); font-size: 14px; display: flex; justify-content: space-between; align-items: center; border: 1px solid var(--border-color);} 
        #profilePageContainer .profile-section { margin-bottom: 18px; padding: 18px; background-color: var(--white-color); border-radius: 8px; text-align:left; box-shadow: 0 1px 4px rgba(0,0,0,0.07); border: 1px solid var(--border-color); } #profilePageContainer .profile-section h3 { font-size: 16px; color: var(--primary-color); margin-bottom: 10px; border-bottom: 1px solid var(--border-color); padding-bottom: 8px; display:flex; align-items:center; gap:8px;} #profilePageContainer .profile-section p { margin: 8px 0; font-size: 14px; color: var(--medium-text); } #profilePageContainer .profile-section strong {color: var(--dark-text);} 
        #profilePageContainer .profile-section .btn.btn-primary { 
          display: block; width:100%; margin-top:12px; background-color: var(--primary-color); color: var(--white-color);
        }
        #profilePageLogoutButton.btn-danger {
            background-color: var(--danger-color);
            color: var(--white-color);
            width: 100%; 
            margin-top: 15px; 
        }
        #orderHistoryPageContainer .tabs { display: flex; margin-bottom: 12px; border-bottom: 1px solid var(--border-color); background-color: var(--white-color); border-radius: 6px 6px 0 0; overflow:hidden;} #orderHistoryPageContainer .tab { padding: 10px 8px; cursor: pointer; flex-grow: 1; text-align: center; font-weight: 500; color: var(--medium-text); font-size: 13px; border-bottom: 3px solid transparent; transition: color 0.2s, border-color 0.2s;} #orderHistoryPageContainer .tab:hover { color: var(--primary-color); } #orderHistoryPageContainer .tab.active { border-bottom: 3px solid var(--primary-color); color: var(--primary-color); font-weight: bold; } 
    </style>
</head>
<body>
    <div id="initialPageLoader">
        <div class="spinner spinner-dark"></div>
    </div>

    <!-- Main Content (Logged out view) -->
    <div class="container" id="mainContent" style="display: none;">
        <div class="photo-box"> <img src="https://assets.onecompiler.app/43efvzmjh/43mjefnfv/1000020219.jpg" alt="T Mart Promotion"> </div>
        <div class="promo-section"> <div class="promo-title">#KuchKhaaakamao</div> <div class="promo-highlight">HAR CHEEZ BECHO SHAAN SE</div> <ul> <li>50 Crore+ Customers - 19000+ Pincodes</li> <li>14 Lakh+ Sellers</li> </ul> <div class="promo-highlight">Build your Brand with Us</div> <div class="stats-container"> <div class="stat-box"> <div class="stat-number">300M+</div> <div class="stat-text">Unique visitors per year visit T Mart</div> </div> <div class="stat-box"> <div class="stat-number">99.3%</div> <div class="stat-text">Indian pincode reach for delivery</div> </div> <div class="stat-box"> <div class="stat-number">38K+</div> <div class="stat-text">Sellers achieved highest-ever single day sales</div> </div> <div class="stat-box"> <div class="stat-number">14L+</div> <div class="stat-text">Sellers are selling on T Mart</div> </div> </div> </div>
        <div class="app-section"> <h2 class="app-title">T Mart App - Shopping Made Awesome!</h2> <p class="app-description"> Download India's fastest growing shopping app today! Get amazing deals, lightning fast delivery, and exclusive app-only offers. </p> <div class="app-features"> <div class="feature">Easy Returns</div> <div class="feature">Cashback Offers</div> <div class="feature">Superfast Delivery</div> <div class="feature">24x7 Support</div> </div> </div>
        <div class="reviews-section"> <h2 class="review-title">What Our Customers Say</h2> <div class="review-box"> <p class="review-text"> "T Mart has changed my shopping experience completely! The app is so easy to use and I get my deliveries faster than anywhere else." </p> <p class="review-author">- Rahul Sharma, Delhi</p> </div> <div class="review-box"> <p class="review-text"> "As a seller, T Mart has helped me reach customers across India. Their seller support is excellent and payments come on time." </p> <p class="review-author">- Priya Patel, Seller from Mumbai</p> </div> <div class="review-box"> <p class="review-text"> "The cashback offers and discounts on T Mart are unbeatable. I've saved thousands of rupees shopping here compared to other platforms." </p> <p class="review-author">- Ankit Verma, Bangalore</p> </div> </div>
    </div>

    <!-- Login/Register Page -->
    <div class="auth-page" id="authPage" style="display: none;">
        <span class="close-auth" onclick="closeAuthPage()">×</span>
        <div class="auth-container">
            <div id="login-form">
                <h2 class="auth-title">Login to Your Account</h2>
                <div id="login-message" class="message"></div>
                <input type="tel" id="login-mobile" class="auth-input" placeholder="Mobile Number">
                <div class="auth-input-container">
                    <input type="password" id="login-password" class="auth-input" placeholder="Password">
                    <i class="fas fa-eye toggle-password" onclick="togglePasswordVisibility('login-password', this)"></i>
                </div>
                <button class="auth-btn" onclick="handleLogin()">Login <span class="spinner" style="display:none;"></span></button>
                <a class="toggle-link" onclick="showRegisterForm()">Don't have an account? Register</a>
            </div>
            <div id="register-form" style="display:none;">
                <h2 class="auth-title">Create Your Account</h2>
                <div id="register-message" class="message"></div>
                <input type="text" id="full-name" class="auth-input" placeholder="Full Name">
                <input type="tel" id="reg-mobile" class="auth-input" placeholder="Mobile Number (10 digits)">
                <input type="text" id="reg-referral-code" class="auth-input" placeholder="Invite Code (Optional)">
                
                <div class="auth-input-container">
                    <input type="password" id="reg-password" class="auth-input" placeholder="Password (min 6 chars)">
                    <i class="fas fa-eye toggle-password" onclick="togglePasswordVisibility('reg-password', this)"></i>
                </div>
                <div class="auth-input-container">
                    <input type="password" id="reg-confirm-password" class="auth-input" placeholder="Confirm Password">
                    <i class="fas fa-eye toggle-password" onclick="togglePasswordVisibility('reg-confirm-password', this)"></i>
                </div>
                <button class="auth-btn" onclick="handleRegister()">Register <span class="spinner" style="display:none;"></span></button>
                <a class="toggle-link" onclick="showLoginForm()">Already have an account? Login</a>
            </div>
        </div>
    </div>

    <!-- NEW APP INTERFACE (HTML Structure) -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;"> <div class="spinner spinner-dark"></div> </div>
    <div id="toastNotification" class="toast-notification"></div>
    <div id="appContainer" style="display: none;">
        <div id="homePage" style="display: none;">
          <div class="app-header"> <h1><i class="fas fa-store-alt"></i> T-Mart</h1> <p class="app-header-subtitle">Jharkhand</p> </div>
          <div class="image-slider-container"><div class="image-slider" id="imageSlider"></div><div class="slider-dots" id="sliderDots"></div></div>
          <h2 class="section-title">Shop by Category</h2>
          <div class="categories-container" id="categoriesContainer"></div>
          <h2 class="section-title">Featured Products</h2>
          <div class="product-grid" id="featuredProductsGrid"></div>
      </div>
      <div id="searchPage" style="display: none;">
          <div class="app-header"><h1><i class="fas fa-search"></i> Search Products</h1></div>
          <div id="searchPageContainer">
              <div class="search-input-container">
                  <input type="text" id="globalSearchInputField" placeholder="Search products by name...">
                  <button class="clear-search-btn" id="clearSearchBtn" onclick="NewApp.clearSearchInput()"><i class="fas fa-times"></i></button>
              </div>
              <div class="product-grid" id="searchResultsGrid"></div>
          </div>
      </div>
      <div id="productDetailPage" style="display: none;">
          <div class="app-header"><h1><i class="fas fa-tag"></i> Product Details</h1></div>
          <div id="productDetailPageContainer"></div>
      </div>
      <div id="cartPage" style="display: none;">
          <div class="app-header"><h1><i class="fas fa-shopping-cart"></i> Your Cart</h1></div>
          <div id="cartPageContainer"></div>
      </div>
      <div id="categoryPage" style="display: none;">
          <div class="app-header"><h1 id="categoryPageHeaderTitle"><i class="fas fa-th-large"></i> Category</h1></div>
          <div id="categoryPageContainer">
              <h2 id="categoryPageTitle" style="text-align:center; margin-bottom:15px; color:var(--primary-color-dark); font-size:18px;">Category Products</h2>
              <div class="search-input-container">
                  <input type="text" id="categorySearchInputField" placeholder="Search within this category...">
              </div>
              <div class="product-grid" id="categoryPageContentGrid"></div>
          </div>
      </div>
      <div id="invitePage" style="display: none;">
          <div class="app-header"><h1><i class="fas fa-gift"></i> Invite & Earn</h1></div>
          <div id="invitePageContainer" class="page-content-container">
              <p>Your current referral earnings:</p>
              <p class="referral-balance" onclick="NewApp.openInviteWithdrawalModal()">₹<span id="inviteReferralEarningsDisplay">0</span></p>
              <p class="referral-balance-text">(Click balance to withdraw if eligible)</p>
              <div class="referral-info"><p><i class="fas fa-check-circle"></i> Invite friends using your code.</p><p><i class="fas fa-check-circle"></i> Friend completes 1 order, You earn ₹20!</p><p><i class="fas fa-check-circle"></i> Min. withdrawal ₹100.</p></div>
              <h3>Your Unique Referral Code:</h3>
              <div class="referral-code-display"><span id="userReferralCodeDisplay"></span> <button class="copy-btn btn btn-primary btn-sm" onclick="NewApp.copyToClipboardById('userReferralCodeDisplay', 'Referral Code')"><i class="fas fa-copy"></i> Copy</button></div>
              <h3>Share Your Referral Link:</h3>
              <div class="invite-link-display"><span id="userReferralLinkDisplay"></span><button class="copy-btn btn btn-primary btn-sm" onclick="NewApp.copyToClipboardById('userReferralLinkDisplay', 'Referral Link')"><i class="fas fa-share-alt"></i> Share</button></div>
          </div>
      </div>
      <div id="profilePage" style="display: none;">
          <div class="app-header"><h1><i class="fas fa-user-circle"></i> My Account</h1></div>
          <div id="profilePageContainer" class="page-content-container">
              <div class="profile-section"><h3><i class="fas fa-mobile-alt"></i> Mobile Number</h3><p id="profileUserEmailDisplay">Mobile not loaded</p></div>
              <div class="profile-section">
                  <h3><i class="fas fa-box-open"></i> My Orders</h3>
                  <p>Total Orders Placed: <strong id="profileTotalOrdersCountDisplay">0</strong></p>
                  <button class="btn btn-primary" onclick="NewApp.showPage('orderHistoryPage')"><i class="fas fa-list-alt"></i> View Order History</button>
              </div>
              <div class="profile-section" style="border: none; box-shadow: none; padding: 15px 0 0 0;">
                <button class="btn btn-danger" id="profilePageLogoutButton" onclick="handleLogout()">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
              </div>
          </div>
      </div>
      <div id="orderHistoryPage" style="display: none;">
          <div class="app-header"><h1><i class="fas fa-history"></i> My Order History</h1></div>
          <div id="orderHistoryPageContainer" class="page-content-container">
              <div class="tabs" id="orderHistoryTabs"><div class="tab active" onclick="NewApp.filterOrderHistory('all',this)">All</div><div class="tab" onclick="NewApp.filterOrderHistory('pending',this)">Pending</div><div class="tab" onclick="NewApp.filterOrderHistory('completed',this)">Completed</div><div class="tab" onclick="NewApp.filterOrderHistory('rejected',this)">Rejected</div></div>
              <div id="orderHistoryContainer"></div>
          </div>
      </div>
      <div id="orderModal" class="modal">
          <div class="modal-content">
              <span class="close-modal-btn" onclick="NewApp.closeOrderModal()">×</span>
              <h2>Place Order</h2>
              <form id="orderForm">
                  <input type="hidden" id="orderProductId">
                  <input type="text" id="orderProductName" readonly placeholder="Product Name">
                  <input type="text" id="orderProductPrice" readonly placeholder="Price">
                  <div class="form-group"> <input type="text" id="customerName" placeholder="Your Full Name" required> </div>
                  <div class="form-group"> <input type="tel" id="customerMobile" placeholder="Mobile Number (10 digits)" pattern="[0-9]{10}" required> </div>
                  <div class="form-group"> <input type="text" id="customerHouseNo" placeholder="House No. / Building Name" required> </div>
                  <div class="form-group"> <input type="text" id="customerMarketName" placeholder="Market Name (e.g., Jhumri Telaiya Market)"> </div>
                  <div class="form-group"> <input type="text" id="customerLandmark" placeholder="Landmark (e.g., मंदिर के पास)"> </div>
                  <div class="form-row"> <div class="form-group"> <input type="text" id="customerPincode" placeholder="Pincode (6 digits)" pattern="[0-9]{6}" required> </div> <div class="form-group"> <input type="text" id="customerVillageCity" placeholder="Village / Town / City" required> </div> </div>
                  <div class="form-row"> <div class="form-group"> <input type="text" id="customerDistrict" placeholder="District" required> </div> <div class="form-group"> <input type="text" id="customerState" placeholder="State" required> </div> </div>
                  <div class="form-row"> <div class="form-group"> <input type="text" id="customerPoliceStation" placeholder="Police Station"> </div> <div class="form-group"> <input type="text" id="customerPostOffice" placeholder="Post Office"> </div> </div>
                  <button type="submit" class="btn btn-secondary btn-block">Confirm Order <span class="spinner" style="display:none;"></span></button>
              </form>
          </div>
      </div>
      <div id="finalConfirmOrderModal" class="modal">
          <div class="modal-content" style="max-width: 320px; text-align: center;">
              <h2>Confirm Your Order?</h2>
              <p style="margin-bottom: 20px; font-size: 14px; color: var(--medium-text);">Please review your details before final confirmation.</p>
              <div style="display: flex; gap: 10px;">
                  <button type="button" class="btn btn-danger" style="flex:1;" onclick="NewApp.closeFinalConfirmOrderModal()">Cancel</button>
                  <button type="button" id="executeFinalOrderBtn" class="btn btn-success" style="flex:1;">
                      Yes, Confirm <span class="spinner" style="display:none;"></span>
                  </button>
              </div>
          </div>
      </div>
      <div id="inviteWithdrawalModal" class="modal">
          <div class="modal-content">
              <span class="close-modal-btn" onclick="NewApp.closeInviteWithdrawalModal()">×</span>
              <h2>Withdrawal</h2>
              <p style="margin-bottom:10px;">Available: ₹<span id="inviteModalAvailableEarningsDisplay">0</span></p>
              <input type="number" id="inviteModalWithdrawAmount" placeholder="Amount (Min ₹100)">
              <input type="text" id="inviteModalUpiId" placeholder="Your UPI ID">
              <button class="btn btn-secondary btn-block" onclick="NewApp.submitInviteWithdrawal()">Submit <span class="spinner" style="display:none;"></span></button>
          </div>
      </div>
      <div id="imagePreviewModal" class="modal" onclick="NewApp.closeImagePreviewModal()">
          <div class="modal-content" onclick="event.stopPropagation();">
              <span class="close-modal-btn" onclick="NewApp.closeImagePreviewModal()">×</span>
              <img id="previewModalImageSrc" src="" alt="Preview">
          </div>
      </div>
    </div> 
    <div class="nav" id="navBar" style="display: none;"> 
      <div class="nav-item active" id="navHome" onclick="NewApp.showPage('homePage')"><i class="fas fa-store-alt"></i><span>Shop</span></div>
      <div class="nav-item" id="navSearch" onclick="NewApp.showPage('searchPage')"><i class="fas fa-search"></i><span>Search</span></div>
      <div class="nav-item" id="navCart" onclick="NewApp.showPage('cartPage')"><i class="fas fa-shopping-cart"></i><span>Cart</span><span id="cartItemCountBadge" class="cart-badge">0</span></div>
      <div class="nav-item" id="navInvite" onclick="NewApp.showPage('invitePage')"><i class="fas fa-gift"></i><span>Invite</span></div>
      <div class="nav-item" id="navProfile" onclick="NewApp.showPage('profilePage')"><i class="fas fa-user-circle"></i><span>Account</span></div>
    </div>

    <div class="fixed-button" id="fixedButtonContainer" style="display: none;">
        <button class="btn btn-signup" id="mainActionButton" onclick="openAuthPage()">
            <i class="fas fa-user-plus"></i> Sign Up/Register
        </button>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    
    <script>
        // --- AUTHENTICATION LOGIC ---
        const firebaseConfig = {
            apiKey: "AIzaSyBpP4hbPKV3OJa8vWic9qPVCLJHIvYHNSQ", 
            authDomain: "botpay-b14a7.firebaseapp.com",
            databaseURL: "https://botpay-b14a7-default-rtdb.firebaseio.com",
            projectId: "botpay-b14a7",
            storageBucket: "botpay-b14a7.appspot.com",
            messagingSenderId: "443474738012",
            appId: "1:443474738012:web:d0d77ed67dfbf6d1565f99",
            measurementId: "G-2GCED5B3DG"
        };
        
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const fbAuth = firebase.auth(); 
        const fbDatabase = firebase.database(); 

        const initialPageLoader = document.getElementById('initialPageLoader');
        const mainContent = document.getElementById('mainContent');
        const authPage = document.getElementById('authPage');
        const fixedButtonContainer = document.getElementById('fixedButtonContainer'); 
        const mainActionButton = document.getElementById('mainActionButton'); 
        
        const appContainer = document.getElementById('appContainer'); 
        const navBar = document.getElementById('navBar'); 

        window.loggedInUserData = { uid: null, mobile: null, firebaseEmail: null, referredByUID: null };
        window.getCurrentUserId = function() { return window.loggedInUserData.uid; };
        window.getCurrentUserMobile = function() { return window.loggedInUserData.mobile; };
        window.getReferringUserUID = function() { return window.loggedInUserData.referredByUID; };

        let authStateConfirmed = false; 

        function openAuthPage() { authPage.style.display = 'block'; showLoginForm(); }
        function closeAuthPage() { authPage.style.display = 'none'; clearMessages(); }
        function showRegisterForm() { document.getElementById('login-form').style.display = 'none'; document.getElementById('register-form').style.display = 'block'; clearMessages(); }
        function showLoginForm() { document.getElementById('register-form').style.display = 'none'; document.getElementById('login-form').style.display = 'block'; clearMessages(); }
        function clearMessages() { const l=document.getElementById('login-message');l.className='message';l.textContent=''; const r=document.getElementById('register-message');r.className='message';r.textContent=''; }
        function showMessage(formId, msg, isError = true) { const el=document.getElementById(`${formId}-message`); if(el){el.textContent=msg; el.className=isError ? 'message error':'message success';}}

        function togglePasswordVisibility(fieldId, iconElement) {
            const passwordField = document.getElementById(fieldId);
            if (passwordField.type === "password") {
                passwordField.type = "text";
                iconElement.classList.remove("fa-eye");
                iconElement.classList.add("fa-eye-slash");
            } else {
                passwordField.type = "password";
                iconElement.classList.remove("fa-eye-slash");
                iconElement.classList.add("fa-eye");
            }
        }
        
        fbAuth.onAuthStateChanged(async (user) => {
            if (!authStateConfirmed) {
                if (initialPageLoader) initialPageLoader.style.display = 'none'; 
                authStateConfirmed = true; 
            }

            if (user) { 
                mainContent.style.display = 'none'; 
                if (authPage.style.display === 'block') closeAuthPage();
                if (fixedButtonContainer) fixedButtonContainer.style.display = 'none'; 

                window.loggedInUserData.uid = user.uid;
                window.loggedInUserData.firebaseEmail = user.email;
                let mobileNumber = user.email.split('@')[0]; 
                try {
                    const snapshot = await fbDatabase.ref('users/' + user.uid).once('value');
                    const userDataFromDB = snapshot.val();
                    if (userDataFromDB) {
                        if (userDataFromDB.mobile) mobileNumber = userDataFromDB.mobile;
                        if (userDataFromDB.referredBy) window.loggedInUserData.referredByUID = userDataFromDB.referredBy; 
                        else window.loggedInUserData.referredByUID = null;
                    } else {
                        window.loggedInUserData.referredByUID = null;
                    }
                } catch (dbError) { 
                    console.error("Error fetching user mobile/referral from DB:", dbError); 
                    window.loggedInUserData.referredByUID = null;
                }
                window.loggedInUserData.mobile = mobileNumber;

                if (appContainer) appContainer.style.display = 'block'; 
                if (navBar) navBar.style.display = 'flex'; 
                
                if (typeof window.NewApp !== 'undefined' && typeof window.NewApp.loadInitialData === 'function' && typeof window.NewApp.showPage === 'function') {
                    await window.NewApp.loadInitialData(); 
                    const currentHash = window.location.hash.substring(1); 
                    if (currentHash && NewApp.pageDivs[currentHash]) {
                        NewApp.showPage(currentHash);
                    } else {
                        NewApp.showPage('homePage'); 
                    }
                } else { console.error("NewApp or its initialization functions not found!"); }
                                
            } else { 
                mainContent.style.display = 'block'; 
                if (appContainer) appContainer.style.display = 'none'; 
                if (navBar) navBar.style.display = 'none'; 
                if (fixedButtonContainer) fixedButtonContainer.style.display = 'flex'; 
                
                if (mainActionButton) {
                    mainActionButton.innerHTML = '<i class="fas fa-user-plus"></i> Sign Up/Register';
                    mainActionButton.onclick = openAuthPage;
                    mainActionButton.classList.remove('btn-logout'); 
                    mainActionButton.classList.add('btn-signup'); 
                }
                window.loggedInUserData = { uid: null, mobile: null, firebaseEmail: null, referredByUID: null };
                if (typeof window.NewApp !== 'undefined' && typeof window.NewApp.clearUserCart === 'function') {
                    NewApp.clearUserCart(); 
                }
            }
        });
        
        const MAX_REGISTRATION_ATTEMPTS = 2; 
        const REGISTRATION_ATTEMPT_KEY = 'tmartRegAttempts';

        async function validateReferralCode(referralCode) {
            if (!referralCode || referralCode.trim() === "") {
                return { isValid: true, isOptionalBypass: true, referrerUID: null };
            }
            try {
                const snapshot = await fbDatabase.ref('userReferrals').orderByChild('referralCode').equalTo(referralCode).once('value');
                if (snapshot.exists()) {
                    let refUID = null;
                    snapshot.forEach(childSnapshot => { refUID = childSnapshot.key; });
                    if (refUID) return { isValid: true, isOptionalBypass: false, referrerUID: refUID };
                }
                return { isValid: true, isOptionalBypass: false, referrerUID: null, codeNotFound: true };
            } catch (error) {
                console.error("Error validating referral code:", error);
                return { isValid: true, isOptionalBypass: false, referrerUID: null, errorValidating: true };
            }
        }

        async function handleRegister() {
            clearMessages();
            const registerButton = document.querySelector('#register-form .auth-btn');
            const registerButtonSpinner = registerButton.querySelector('.spinner');
            if (registerButtonSpinner) registerButtonSpinner.style.display = 'inline-block';
            registerButton.disabled = true;

            let registrationAttempts = parseInt(localStorage.getItem(REGISTRATION_ATTEMPT_KEY) || '0');
            if (registrationAttempts >= MAX_REGISTRATION_ATTEMPTS) {
                showMessage('register', `Device registration limit (${MAX_REGISTRATION_ATTEMPTS} attempts) reached.`);
                if (registerButtonSpinner) registerButtonSpinner.style.display = 'none';
                registerButton.disabled = false;
                return;
            }

            const fullName = document.getElementById('full-name').value.trim();
            const mobile = document.getElementById('reg-mobile').value.trim();
            const referralCodeInput = document.getElementById('reg-referral-code').value.trim();
            const password = document.getElementById('reg-password').value;
            const confirmPassword = document.getElementById('reg-confirm-password').value;
            
            if (!fullName || !mobile || !password || !confirmPassword) {
                showMessage('register', 'Full Name, Mobile, and Password fields are required.');
                if (registerButtonSpinner) registerButtonSpinner.style.display = 'none';
                registerButton.disabled = false;
                return;
            }
            if (mobile.length !== 10 || !/^\d+$/.test(mobile)) {
                showMessage('register', 'Mobile number must be 10 digits.');
                if (registerButtonSpinner) registerButtonSpinner.style.display = 'none';
                registerButton.disabled = false;
                return;
            }
            if (password.length < 6) {
                showMessage('register', 'Password must be at least 6 characters.');
                if (registerButtonSpinner) registerButtonSpinner.style.display = 'none';
                registerButton.disabled = false;
                return;
            }
            if (password !== confirmPassword) {
                showMessage('register', 'Passwords do not match.');
                if (registerButtonSpinner) registerButtonSpinner.style.display = 'none';
                registerButton.disabled = false;
                return;
            }

            let referrerUID = null;
            if (referralCodeInput) {
                const referralValidation = await validateReferralCode(referralCodeInput);
                if (referralValidation.isValid && !referralValidation.isOptionalBypass && !referralValidation.codeNotFound && !referralValidation.errorValidating) {
                    referrerUID = referralValidation.referrerUID;
                }
            }

            try {
                const email = `${mobile}@tmart.com`;
                showMessage('register', 'Registering account...', false);
                const userCredential = await fbAuth.createUserWithEmailAndPassword(email, password);
                const newUserUID = userCredential.user.uid;
                const userData = {
                    fullName: fullName, mobile: mobile, email: email,
                    registrationTimestamp: firebase.database.ServerValue.TIMESTAMP
                };
                if (referrerUID) userData.referredBy = referrerUID;
                await fbDatabase.ref('users/' + newUserUID).set(userData);

                const newUserReferralCode = "TMT" + Math.random().toString(36).substring(2, 7).toUpperCase();
                await fbDatabase.ref('userReferrals/' + newUserUID).set({
                    referralCode: newUserReferralCode, earnings: 0,
                    minWithdrawal: 100, rewardPerOrder: 20, userId: newUserUID 
                });
                
                localStorage.setItem(REGISTRATION_ATTEMPT_KEY, registrationAttempts + 1);
                showMessage('register', 'Registration successful! Please login.', false);
                setTimeout(() => { showLoginForm(); }, 2000);
            } catch (error) {
                let em = 'Registration failed. ';
                if (error.code === 'auth/email-already-in-use') em += 'This mobile number is already registered.';
                else em += error.message;
                showMessage('register', em);
            } finally {
                if (registerButtonSpinner) registerButtonSpinner.style.display = 'none';
                registerButton.disabled = false;
            }
        }

        async function handleLogin() {
            const loginButton = document.querySelector('#login-form .auth-btn');
            const loginButtonSpinner = loginButton.querySelector('.spinner');
            if (loginButtonSpinner) loginButtonSpinner.style.display = 'inline-block';
            loginButton.disabled = true;

            const mobile = document.getElementById('login-mobile').value.trim();
            const password = document.getElementById('login-password').value;
            clearMessages();
            if (!mobile || !password) { 
                showMessage('login', 'Mobile and password are required'); 
                if (loginButtonSpinner) loginButtonSpinner.style.display = 'none';
                loginButton.disabled = false;
                return; 
            }
            if (mobile.length !== 10 || !/^\d+$/.test(mobile)) { 
                showMessage('login', 'Mobile number must be 10 digits'); 
                if (loginButtonSpinner) loginButtonSpinner.style.display = 'none';
                loginButton.disabled = false;
                return; 
            }
            try {
                const email = `${mobile}@tmart.com`; 
                showMessage('login', 'Logging in...', false); 
                await fbAuth.signInWithEmailAndPassword(email, password);
            } catch (error) {
                let errorMessage = 'Login failed. ';
                if (error.code === 'auth/wrong-password' || error.code === 'auth/user-not-found' || error.code === 'auth/invalid-credential') {
                    errorMessage += 'Invalid mobile number or password.';
                } else { errorMessage += error.message; }
                showMessage('login', errorMessage);
            } finally {
                if (loginButtonSpinner) loginButtonSpinner.style.display = 'none';
                loginButton.disabled = false;
            }
        }

        async function handleLogout() { 
            try { await fbAuth.signOut(); console.log("User logged out successfully."); } 
            catch (error) { console.error("Logout failed:", error); alert("Logout failed: " + error.message); }
        }
    </script>

    <!-- PART 2 starts below this comment -->